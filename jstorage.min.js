(function(){function e(){var e=!1;if("localStorage"in window)try{window.localStorage.setItem("_tmptest","tmpval"),e=!0,window.localStorage.removeItem("_tmptest")}catch(t){}if(e)try{window.localStorage&&(S=window.localStorage,T="localStorage",L=S.jStorage_update)}catch(o){}else if("globalStorage"in window)try{window.globalStorage&&(S=window.globalStorage[window.location.hostname],T="globalStorage",L=S.jStorage_update)}catch(r){}else{if(y=document.createElement("link"),!y.addBehavior)return y=null,void 0;y.style.behavior="url(#default#userData)",document.getElementsByTagName("head")[0].appendChild(y);try{y.load("jStorage")}catch(s){y.setAttribute("jStorage","{}"),y.save("jStorage"),y.load("jStorage")}var l="{}";try{l=y.getAttribute("jStorage")}catch(c){}try{L=y.getAttribute("jStorage_update")}catch(p){}S.jStorage=l,T="userDataBehavior"}i(),u(),a(),h(),"addEventListener"in window&&window.addEventListener("pageshow",function(e){e.persisted&&n()},!1)}function t(){var e="{}";if("userDataBehavior"==T){y.load("jStorage");try{e=y.getAttribute("jStorage")}catch(t){}try{L=y.getAttribute("jStorage_update")}catch(a){}S.jStorage=e}i(),u(),h()}function a(){"localStorage"==T||"globalStorage"==T?"addEventListener"in window?window.addEventListener("storage",n,!1):document.attachEvent("onstorage",n):"userDataBehavior"==T&&setInterval(n,1e3)}function n(){var e;clearTimeout(R),R=setTimeout(function(){if("localStorage"==T||"globalStorage"==T)e=S.jStorage_update;else if("userDataBehavior"==T){y.load("jStorage");try{e=y.getAttribute("jStorage_update")}catch(t){}}e&&e!=L&&(L=e,o())},25)}function o(){var e,a=v.parse(v.stringify(j.__jstorage_meta.CRC32));t(),e=v.parse(v.stringify(j.__jstorage_meta.CRC32));var n,o=[],s=[];for(n in a)if(a.hasOwnProperty(n)){if(!e[n]){s.push(n);continue}a[n]!=e[n]&&"2."==(a[n]+"").substr(0,2)&&o.push(n)}for(n in e)e.hasOwnProperty(n)&&(a[n]||o.push(n));r(o,"updated"),r(s,"deleted")}function r(e,t){if(e=[].concat(e||[]),"flushed"==t){e=[];for(var a in C)C.hasOwnProperty(a)&&e.push(a);t="deleted"}for(var n=0,o=e.length;o>n;n++)if(C[e[n]])for(var r=0,s=C[e[n]].length;s>r;r++)C[e[n]][r](e[n],t)}function s(){var e=""+ +new Date;"localStorage"==T||"globalStorage"==T?S.jStorage_update=e:"userDataBehavior"==T&&(y.setAttribute("jStorage_update",e),y.save("jStorage")),n()}function i(){if(S.jStorage)try{j=v.parse(S.jStorage+"")}catch(e){S.jStorage="{}"}else S.jStorage="{}";w=S.jStorage?(S.jStorage+"").length:0,j.__jstorage_meta||(j.__jstorage_meta={}),j.__jstorage_meta.CRC32||(j.__jstorage_meta.CRC32={})}function l(){g();try{S.jStorage=v.stringify(j),y&&(y.setAttribute("jStorage",S.jStorage),y.save("jStorage")),w=S.jStorage?(S.jStorage+"").length:0}catch(e){}}function c(e){if(!e||"string"!=typeof e&&"number"!=typeof e)throw new TypeError("Key name must be string or numeric");if("__jstorage_meta"==e)throw new TypeError("Reserved key name");return!0}function u(){var e,t,a,n,o=1/0,i=!1,c=[];if(clearTimeout(b),j.__jstorage_meta&&"object"==typeof j.__jstorage_meta.TTL){e=+new Date,a=j.__jstorage_meta.TTL,n=j.__jstorage_meta.CRC32;for(t in a)a.hasOwnProperty(t)&&(e>=a[t]?(delete a[t],delete n[t],delete j[t],i=!0,c.push(t)):o>a[t]&&(o=a[t]));1/0!=o&&(b=setTimeout(u,o-e)),i&&(l(),s(),r(c,"deleted"))}}function h(){var e,t;if(j.__jstorage_meta.PubSub){var a,n=z;for(e=t=j.__jstorage_meta.PubSub.length-1;e>=0;e--)a=j.__jstorage_meta.PubSub[e],a[0]>z&&(n=a[0],p(a[1],a[2]));z=n}}function p(e,t){if(O[e])for(var a=0,n=O[e].length;n>a;a++)O[e][a](e,v.parse(v.stringify(t)))}function g(){if(j.__jstorage_meta.PubSub){for(var e=+new Date-2e3,t=0,a=j.__jstorage_meta.PubSub.length;a>t;t++)if(e>=j.__jstorage_meta.PubSub[t][0]){j.__jstorage_meta.PubSub.splice(t,j.__jstorage_meta.PubSub.length-t);break}j.__jstorage_meta.PubSub.length||delete j.__jstorage_meta.PubSub}}function d(e,t){j.__jstorage_meta||(j.__jstorage_meta={}),j.__jstorage_meta.PubSub||(j.__jstorage_meta.PubSub=[]),j.__jstorage_meta.PubSub.unshift([+new Date,e,t]),l(),s()}function f(e,t){for(var a,n=e.length,o=t^n,r=0,s=255,i=65535,l=1540483477;n>=4;)a=e.charCodeAt(r)&s|(e.charCodeAt(++r)&s)<<8|(e.charCodeAt(++r)&s)<<16|(e.charCodeAt(++r)&s)<<24,a=(a&i)*l+(((a>>>16)*l&i)<<16),a^=a>>>24,a=(a&i)*l+(((a>>>16)*l&i)<<16),o=(o&i)*l+(((o>>>16)*l&i)<<16)^a,n-=4,++r;switch(n){case 3:o^=(e.charCodeAt(r+2)&s)<<16;case 2:o^=(e.charCodeAt(r+1)&s)<<8;case 1:o^=e.charCodeAt(r)&s,o=(o&i)*l+(((o>>>16)*l&i)<<16)}return o^=o>>>13,o=(o&i)*l+(((o>>>16)*l&i)<<16),o^=o>>>15,o>>>0}var _="0.4.2-lite",m=window.jQuery||window.$||(window.$={}),v={parse:window.JSON&&(window.JSON.parse||window.JSON.decode)||String.prototype.evalJSON&&function(e){return(e+"").evalJSON()}||m.parseJSON||m.evalJSON,stringify:Object.toJSON||window.JSON&&(window.JSON.stringify||window.JSON.encode)||m.toJSON};if(!v.parse||!v.stringify)throw Error("No JSON support found, include //cdnjs.cloudflare.com/ajax/libs/json2/20110223/json2.js to page");var b,j={__jstorage_meta:{CRC32:{}}},S={jStorage:"{}"},y=null,w=0,T=!1,C={},R=!1,L=0,O={},z=+new Date;m.jStorage={version:_,set:function(e,t,a){return c(e),a=a||{},t===void 0?(this.deleteKey(e),t):"function"==typeof t?void 0:(t&&"object"==typeof t&&(t=v.parse(v.stringify(t))),j[e]=t,j.__jstorage_meta.CRC32[e]="2."+f(v.stringify(t),2538058380),this.setTTL(e,a.TTL||0),r(e,"updated"),t)},get:function(e,t){return c(e),e in j?j[e]:t===void 0?null:t},deleteKey:function(e){return c(e),e in j?(delete j[e],"object"==typeof j.__jstorage_meta.TTL&&e in j.__jstorage_meta.TTL&&delete j.__jstorage_meta.TTL[e],delete j.__jstorage_meta.CRC32[e],l(),s(),r(e,"deleted"),!0):!1},setTTL:function(e,t){var a=+new Date;return c(e),t=Number(t)||0,e in j?(j.__jstorage_meta.TTL||(j.__jstorage_meta.TTL={}),t>0?j.__jstorage_meta.TTL[e]=a+t:delete j.__jstorage_meta.TTL[e],l(),u(),s(),!0):!1},getTTL:function(e){var t,a=+new Date;return c(e),e in j&&j.__jstorage_meta.TTL&&j.__jstorage_meta.TTL[e]?(t=j.__jstorage_meta.TTL[e]-a,t||0):0},flush:function(){return j={__jstorage_meta:{CRC32:{}}},l(),s(),r(null,"flushed"),!0},storageObj:function(){function e(){}return e.prototype=j,new e},index:function(){var e,t=[];for(e in j)j.hasOwnProperty(e)&&"__jstorage_meta"!=e&&t.push(e);return t},storageSize:function(){return w},currentBackend:function(){return T},storageAvailable:function(){return!!T},listenKeyChange:function(e,t){c(e),C[e]||(C[e]=[]),C[e].push(t)},stopListening:function(e,t){if(c(e),C[e]){if(!t)return delete C[e],void 0;for(var a=C[e].length-1;a>=0;a--)C[e][a]==t&&C[e].splice(a,1)}},subscribe:function(e,t){if(e=""+(e||""),!e)throw new TypeError("Channel not defined");O[e]||(O[e]=[]),O[e].push(t)},publish:function(e,t){if(e=""+(e||""),!e)throw new TypeError("Channel not defined");d(e,t)},reInit:function(){t()}},e()})();